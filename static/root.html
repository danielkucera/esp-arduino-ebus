<!DOCTYPE html>
<html lang="en">

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <title>esp-eBus Adapter</title>
    <link rel="stylesheet" href="common.css">
</head>

<body class="centered">
    <div style='text-align:left;display:inline-block;min-width:260px;'>
        <h1>esp-eBus Adapter</h1>

        <fieldset>
            <legend>Adapter</legend>
            <div>
                <a href='/config' class="link-button">Configuration</a>
                <a href='/firmware' class="link-button">Firmware Update</a>
                <a href='/status' class="link-button">Status</a>
                <a href="/commands" class="link-button disabled" id="Commands">Commands</a>
                <a href="/values" class="link-button disabled" id="Values">Values</a>
                <a href="/devices" class="link-button disabled" id="Devices">Devices</a>
                <a href="/statistics" class="link-button disabled" id="Statistics">Statistics</a>
                <a href="/logs" class="link-button disabled" id="Logs">Logs</a>
                <a href='/restart' class="link-button danger" onclick="return confirmAction('restart');">Restart</a>
            </div>
            <div class="info-box">
                <strong>Login:</strong><br>
                user: <em>admin</em><br>
                password: your configured AP mode password or default
            </div>
        </fieldset>

        <div style='font-size:.6em;margin-top:20px;'>
            Project: <a href='https://github.com/danielkucera/esp-arduino-ebus' target='_blank'>esp-arduino-ebus on
                GitHub</a>
        </div>
    </div>

    <script type='text/javascript'>
        function confirmAction(action) {
            return confirm("Are you sure you want to " + action + "?");
        }

        function checkEndpoint() {
            const url = '/devices';
            const links = document.querySelectorAll('.link-button');

            fetch(url, { method: 'HEAD' })
                .then(response => {
                    if (response.ok) {
                        links.forEach(link => {
                            link.classList.remove('disabled');
                            link.style.pointerEvents = 'auto';
                        });
                    } else {
                        links.forEach(link => {
                            link.classList.add('disabled');
                            link.style.pointerEvents = 'none';
                        });
                    }
                })
                .catch(error => {
                    links.forEach(link => {
                        link.classList.add('disabled');
                        link.style.pointerEvents = 'none';
                    });
                });
        }

        // Call checkEndpoint on page load
        window.onload = checkEndpoint;
    </script>
</body>

</html>